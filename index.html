<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Mockup Generator</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            text-align: center;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }

        h1 {
            color: #222;
            margin-bottom: 10px;
            font-weight: 300;
            font-size: 2.2em;
        }

        .subtitle {
            color: #666;
            margin-bottom: 20px;
            font-size: 1.1em;
            font-weight: 300;
        }

        /* Product Category Selection */
        .product-category-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 30px;
        }

        .product-category-link {
            color: #4CAF50;
            text-decoration: none;
            font-weight: 400;
            font-size: 1em;
            padding: 12px 24px;
            border: 1px solid #4CAF50;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .product-category-link:hover, .product-category-link.active {
            background-color: #4CAF50;
            color: white;
        }

        /* Product Type Selection (nested under category) */
        .product-type-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 30px;
        }

        .product-type-link {
            color: #2196F3;
            text-decoration: none;
            font-weight: 400;
            font-size: 0.95em;
            padding: 10px 18px;
            border: 1px solid #2196F3;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .product-type-link:hover, .product-type-link.active {
            background-color: #2196F3;
            color: white;
        }

        #controls {
            margin: 20px auto;
            padding: 15px;
            background: white;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            max-width: 800px;
        }

        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 18px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 400;
            transition: background-color 0.2s ease;
            letter-spacing: 0.5px;
        }

        button:hover {
            background: #3d8b40;
        }

        /* Product-specific styles */
        .product-section {
            display: none;
        }

        .product-section.active {
            display: block;
        }

        /* Phone Case Specific Styles */
        #main-mockup-container {
            position: relative;
            display: inline-block;
            margin: 20px auto;
            width: 800px;
            height: 800px;
            overflow: hidden;
            background-color: white;
        }

        .phone-case-bg, .phone-case-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: auto;
        }

        .phone-case-bg {
            z-index: 1;
        }

        .design-area {
            position: absolute;
            z-index: 2;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .user-design {
            position: absolute;
            max-width: 100%;
            max-height: 100%;
            top: 48.5%;
            left: 48.5%;
            transform: translate(-50%, -50%);
            object-fit: contain;
            display: none; /* Hidden by default */
        }

        .phone-case-overlay {
            z-index: 3;
            pointer-events: none;
        }

        /* Grid View Styles */
        .grid-wrapper {
            max-width: 1600px;
            margin: 20px auto;
            padding: 0 20px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin: 0 auto;
        }

        .grid-item {
            position: relative;
            background: white;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .grid-item .secondary-mockup {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 100%; /* Square aspect ratio */
        }

        .grid-item .phone-case-bg,
        .grid-item .phone-case-overlay,
        .grid-item .design-area {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .grid-item .design-area {
            z-index: 2;
        }

        .grid-item .phone-case-overlay {
            z-index: 3;
        }

        .grid-item .carousel-checkbox {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 4;
            width: 20px;
            height: 20px;
        }

        .mockup-label {
            padding: 10px;
            font-size: 0.9em;
            color: #555;
        }

        .hidden {
            display: none;
        }

        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 1.2em;
            flex-direction: column;
            font-weight: 300;
        }

        .spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #4CAF50;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .grid-container {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 900px) {
            .grid-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 600px) {
            .grid-container {
                grid-template-columns: 1fr;
            }
            
            #main-mockup-container {
                width: 100%;
                height: auto;
                max-width: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="loading">
        <div class="spinner"></div>
        <div>Generating your mockups...</div>
    </div>
    
    <h1>Product Mockup Generator</h1>
    <div class="subtitle">Select a product category to get started</div>
    
    <!-- Product Category Selection -->
    <div class="product-category-container">
        <a href="#" class="product-category-link active" data-category="phone-cases">Phone Cases</a>
        <a href="#" class="product-category-link" data-category="plaques">Plaques</a>
        <a href="#" class="product-category-link" data-category="tshirts">T-Shirts</a>
        <a href="#" class="product-category-link" data-category="bags">Bags</a>
    </div>
    
    <!-- Product Sections -->
    <div id="phone-cases" class="product-section active">
        <!-- Phone Case Type Selection -->
        <div class="product-type-container">
            <a href="#" class="product-type-link active" data-case="samsung-tpu">Clear TPU case for Samsung</a>
            <a href="#" class="product-type-link" data-case="iphone-tpu">Clear TPU case for iPhone</a>
            <a href="#" class="product-type-link" data-case="iphone-hybrid">Clear Hybrid case for iPhone</a>
            <a href="#" class="product-type-link" data-case="pixel-tpu">Clear TPU case for Google Pixel</a>
            <a href="#" class="product-type-link" data-case="iphone-fullprint">Full print case for iPhone</a>
        </div>
        
<div id="controls">
    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
        <div style="position: relative; display: inline-block;">
            <input type="file" id="image-upload" accept="image/*">
            <button id="remove-btn" style="display: none; position: absolute; right: -12px; top: -12px; background: #ff4444; color: white; border: none; border-radius: 50%; width: 24px; height: 24px; padding: 0; cursor: pointer; font-size: 12px; line-height: 24px;">Ã—</button>
        </div>
        <div style="display: flex; gap: 10px;">
            <button id="download-btn">Download Main Mockup</button>
            <button id="download-zip-btn">Download Selected Views as ZIP</button>
        </div>
    </div>
</div>
    
    <!-- Samsung TPU Mockups -->
    <div id="samsung-tpu" class="case-mockups">
        <!-- Main Mockup -->
        <div id="main-mockup-container">
            <img class="phone-case-bg" src="mockups/samsung-tpu-back-main.png">
            <div class="design-area">
                <img class="user-design" src="" alt="" 
                     data-x="48.5" data-y="48.5" data-scale="100" data-rotation="0">
            </div>
            <img class="phone-case-overlay" src="mockups/samsung-tpu-overlay-main.png">
        </div>

        <!-- Secondary Mockups Grid -->
        <div class="grid-wrapper">
            <div class="grid-container">
                <div class="grid-item">
                    <div class="secondary-mockup">
                        <input type="checkbox" class="carousel-checkbox" data-view="1">
                        <img class="phone-case-bg" src="mockups/samsung-tpu-view1.png">
                        <div class="design-area">
                            <img class="user-design" src="" alt="" 
                                 data-x="47.12" data-y="50" data-scale="70" data-rotation="15">
                        </div>
                        <img class="phone-case-overlay" src="mockups/samsung-tpu-view1-overlay.png">
                    </div>
                    <div class="mockup-label">View 1</div>
                </div>
                <div class="grid-item">
                    <div class="secondary-mockup">
                        <input type="checkbox" class="carousel-checkbox" data-view="2">
                        <img class="phone-case-bg" src="mockups/samsung-tpu-view2.png">
                        <div class="design-area">
                            <img class="user-design" src="" alt="" 
                                 data-x="50" data-y="50" data-scale="100" data-rotation="0">
                        </div>
                        <img class="phone-case-overlay" src="mockups/samsung-tpu-view2-overlay.png">
                    </div>
                    <div class="mockup-label">View 2</div>
                </div>
                <div class="grid-item">
                    <div class="secondary-mockup">
                        <input type="checkbox" class="carousel-checkbox" data-view="3">
                        <img class="phone-case-bg" src="mockups/samsung-tpu-view3.png">
                        <div class="design-area">
                            <img class="user-design" src="" alt="" 
                                 data-x="50" data-y="50" data-scale="100" data-rotation="0">
                        </div>
                        <img class="phone-case-overlay" src="mockups/samsung-tpu-view3-overlay.png">
                    </div>
                    <div class="mockup-label">View 3</div>
                </div>
                <div class="grid-item">
                    <div class="secondary-mockup">
                        <input type="checkbox" class="carousel-checkbox" data-view="4">
                        <img class="phone-case-bg" src="mockups/samsung-tpu-view4.png">
                        <div class="design-area">
                            <img class="user-design" src="" alt="" 
                                 data-x="50" data-y="50" data-scale="100" data-rotation="0">
                        </div>
                        <img class="phone-case-overlay" src="mockups/samsung-tpu-view4-overlay.png">
                    </div>
                    <div class="mockup-label">View 4</div>
                </div>
                <div class="grid-item">
                    <div class="secondary-mockup">
                        <input type="checkbox" class="carousel-checkbox" data-view="5">
                        <img class="phone-case-bg" src="mockups/samsung-tpu-view5.png">
                        <div class="design-area">
                            <img class="user-design" src="" alt="" 
                                 data-x="50" data-y="50" data-scale="100" data-rotation="0">
                        </div>
                        <img class="phone-case-overlay" src="mockups/samsung-tpu-view5-overlay.png">
                    </div>
                    <div class="mockup-label">View 5</div>
                </div>
                <div class="grid-item">
                    <div class="secondary-mockup">
                        <input type="checkbox" class="carousel-checkbox" data-view="6">
                        <img class="phone-case-bg" src="mockups/samsung-tpu-view6.png">
                        <div class="design-area">
                            <img class="user-design" src="" alt="" 
                                 data-x="50" data-y="50" data-scale="100" data-rotation="0">
                        </div>
                        <img class="phone-case-overlay" src="mockups/samsung-tpu-view6-overlay.png">
                    </div>
                    <div class="mockup-label">View 6</div>
                </div>
                <div class="grid-item">
                    <div class="secondary-mockup">
                        <input type="checkbox" class="carousel-checkbox" data-view="7">
                        <img class="phone-case-bg" src="mockups/samsung-tpu-view7.png">
                        <div class="design-area">
                            <img class="user-design" src="" alt="" 
                                 data-x="50" data-y="50" data-scale="100" data-rotation="0">
                        </div>
                        <img class="phone-case-overlay" src="mockups/samsung-tpu-view7-overlay.png">
                    </div>
                    <div class="mockup-label">View 7</div>
                </div>
                <div class="grid-item">
                    <div class="secondary-mockup">
                        <input type="checkbox" class="carousel-checkbox" data-view="8">
                        <img class="phone-case-bg" src="mockups/samsung-tpu-view8.png">
                        <div class="design-area">
                            <img class="user-design" src="" alt="" 
                                 data-x="50" data-y="50" data-scale="100" data-rotation="0">
                        </div>
                        <img class="phone-case-overlay" src="mockups/samsung-tpu-view8-overlay.png">
                    </div>
                    <div class="mockup-label">View 8</div>
                </div>
                <div class="grid-item">
                    <div class="secondary-mockup">
                        <input type="checkbox" class="carousel-checkbox" data-view="9">
                        <img class="phone-case-bg" src="mockups/samsung-tpu-view9.png">
                        <div class="design-area">
                            <img class="user-design" src="" alt="" 
                                 data-x="50" data-y="50" data-scale="100" data-rotation="0">
                        </div>
                        <img class="phone-case-overlay" src="mockups/samsung-tpu-view9-overlay.png">
                    </div>
                    <div class="mockup-label">View 9</div>
                </div>
                <div class="grid-item">
                    <div class="secondary-mockup">
                        <input type="checkbox" class="carousel-checkbox" data-view="10">
                        <img class="phone-case-bg" src="mockups/samsung-tpu-view10.png">
                        <div class="design-area">
                            <img class="user-design" src="" alt="" 
                                 data-x="50" data-y="50" data-scale="100" data-rotation="0">
                        </div>
                        <img class="phone-case-overlay" src="mockups/samsung-tpu-view10-overlay.png">
                    </div>
                    <div class="mockup-label">View 10</div>
            </div>
        </div>
    </div>
</div>

    
<!-- iPhone TPU Mockups -->
<div id="iphone-tpu" class="case-mockups">
    <!-- Main Mockup -->
    <div id="main-mockup-container">
        <img class="phone-case-bg" src="mockups/iphone-tpu-back-main.png">
        <div class="design-area">
            <img class="user-design" src="" alt="" 
                 data-x="48.5" data-y="48.5" data-scale="100" data-rotation="0">
        </div>
        <img class="phone-case-overlay" src="mockups/iphone-tpu-overlay-main.png">
    </div>

    <!-- Secondary Mockups Grid -->
    <div class="grid-wrapper">
        <div class="grid-container">
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="1">
                    <img class="phone-case-bg" src="mockups/iphone-tpu-view1.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="47" data-y="50" data-scale="68" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-tpu-view1-overlay.png">
                </div>
                <div class="mockup-label">View 1</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="2">
                    <img class="phone-case-bg" src="mockups/iphone-tpu-view2.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="60" data-scale="90" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-tpu-view2-overlay.png">
                </div>
                <div class="mockup-label">View 2</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="3">
                    <img class="phone-case-bg" src="mockups/iphone-tpu-view3.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50.48" data-y="49,84" data-scale="105" data-rotation="-24.42">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-tpu-view3-overlay.png">
                </div>
                <div class="mockup-label">View 3</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="4">
                    <img class="phone-case-bg" src="mockups/iphone-tpu-view4.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="53.97" data-y="48.08" data-scale="88.59" data-rotation="-1.04">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-tpu-view4-overlay.png">
                </div>
                <div class="mockup-label">View 4</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="5">
                    <img class="phone-case-bg" src="mockups/iphone-tpu-view5.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50.2" data-y="50.75" data-scale="93.02" data-rotation="0.27">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-tpu-view5-overlay.png">
                </div>
                <div class="mockup-label">View 5</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="6">
                    <img class="phone-case-bg" src="mockups/iphone-tpu-view6.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-tpu-view6-overlay.png">
                </div>
                <div class="mockup-label">View 6</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="7">
                    <img class="phone-case-bg" src="mockups/iphone-tpu-view7.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-tpu-view7-overlay.png">
                </div>
                <div class="mockup-label">View 7</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="8">
                    <img class="phone-case-bg" src="mockups/iphone-tpu-view8.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-tpu-view8-overlay.png">
                </div>
                <div class="mockup-label">View 8</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="9">
                    <img class="phone-case-bg" src="mockups/iphone-tpu-view9.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-tpu-view9-overlay.png">
                </div>
                <div class="mockup-label">View 9</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="10">
                    <img class="phone-case-bg" src="https://tullun-mockup-generator.s3.us-east-2.amazonaws.com/iphone-tpu-view10.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="https://tullun-mockup-generator.s3.us-east-2.amazonaws.com/iphone-tpu-view10-overlay.png">
                </div>
                <div class="mockup-label">View 10</div>
            </div>
        </div>
    </div>
</div>


<!-- iPhone Hybrid Mockups -->
<div id="iphone-hybrid" class="case-mockups">
    <!-- Main Mockup -->
    <div id="main-mockup-container">
        <img class="phone-case-bg" src="mockups/iphone-hybrid-back-main.png">
        <div class="design-area">
            <img class="user-design" src="" alt="" 
                 data-x="48.5" data-y="48.5" data-scale="100" data-rotation="0">
        </div>
        <img class="phone-case-overlay" src="mockups/iphone-hybrid-overlay-main.png">
    </div>

    <!-- Secondary Mockups Grid -->
    <div class="grid-wrapper">
        <div class="grid-container">
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="1">
                    <img class="phone-case-bg" src="mockups/iphone-hybrid-view1.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="60" data-y="60" data-scale="60" data-rotation="30">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-hybrid-view1-overlay.png">
                </div>
                <div class="mockup-label">View 1</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="2">
                    <img class="phone-case-bg" src="mockups/iphone-hybrid-view2.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-hybrid-view2-overlay.png">
                </div>
                <div class="mockup-label">View 2</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="3">
                    <img class="phone-case-bg" src="mockups/iphone-hybrid-view3.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-hybrid-view3-overlay.png">
                </div>
                <div class="mockup-label">View 3</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="4">
                    <img class="phone-case-bg" src="mockups/iphone-hybrid-view4.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-hybrid-view4-overlay.png">
                </div>
                <div class="mockup-label">View 4</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="5">
                    <img class="phone-case-bg" src="mockups/iphone-hybrid-view5.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-hybrid-view5-overlay.png">
                </div>
                <div class="mockup-label">View 5</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="6">
                    <img class="phone-case-bg" src="mockups/iphone-hybrid-view6.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-hybrid-view6-overlay.png">
                </div>
                <div class="mockup-label">View 6</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="7">
                    <img class="phone-case-bg" src="mockups/iphone-hybrid-view7.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-hybrid-view7-overlay.png">
                </div>
                <div class="mockup-label">View 7</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="8">
                    <img class="phone-case-bg" src="mockups/iphone-hybrid-view8.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-hybrid-view8-overlay.png">
                </div>
                <div class="mockup-label">View 8</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="9">
                    <img class="phone-case-bg" src="mockups/iphone-hybrid-view9.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-hybrid-view9-overlay.png">
                </div>
                <div class="mockup-label">View 9</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="10">
                    <img class="phone-case-bg" src="mockups/iphone-hybrid-view10.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-hybrid-view10-overlay.png">
                </div>
                <div class="mockup-label">View 10</div>
            </div>
        </div>
    </div>
</div>

<!-- Pixel TPU Mockups -->
<div id="pixel-tpu" class="case-mockups">
    <!-- Main Mockup -->
    <div id="main-mockup-container">
        <img class="phone-case-bg" src="mockups/pixel-tpu-back-main.png">
        <div class="design-area">
            <img class="user-design" src="" alt="" 
                 data-x="48.5" data-y="48.5" data-scale="100" data-rotation="0">
        </div>
        <img class="phone-case-overlay" src="mockups/pixel-tpu-overlay-main.png">
    </div>

    <!-- Secondary Mockups Grid -->
    <div class="grid-wrapper">
        <div class="grid-container">
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="1">
                    <img class="phone-case-bg" src="mockups/pixel-tpu-view1.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="60" data-y="60" data-scale="60" data-rotation="30">
                    </div>
                    <img class="phone-case-overlay" src="mockups/pixel-tpu-view1-overlay.png">
                </div>
                <div class="mockup-label">View 1</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="2">
                    <img class="phone-case-bg" src="mockups/pixel-tpu-view2.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/pixel-tpu-view2-overlay.png">
                </div>
                <div class="mockup-label">View 2</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="3">
                    <img class="phone-case-bg" src="mockups/pixel-tpu-view3.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/pixel-tpu-view3-overlay.png">
                </div>
                <div class="mockup-label">View 3</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="4">
                    <img class="phone-case-bg" src="mockups/pixel-tpu-view4.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/pixel-tpu-view4-overlay.png">
                </div>
                <div class="mockup-label">View 4</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="5">
                    <img class="phone-case-bg" src="mockups/pixel-tpu-view5.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/pixel-tpu-view5-overlay.png">
                </div>
                <div class="mockup-label">View 5</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="6">
                    <img class="phone-case-bg" src="mockups/pixel-tpu-view6.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/pixel-tpu-view6-overlay.png">
                </div>
                <div class="mockup-label">View 6</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="7">
                    <img class="phone-case-bg" src="mockups/pixel-tpu-view7.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/pixel-tpu-view7-overlay.png">
                </div>
                <div class="mockup-label">View 7</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="8">
                    <img class="phone-case-bg" src="mockups/pixel-tpu-view8.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/pixel-tpu-view8-overlay.png">
                </div>
                <div class="mockup-label">View 8</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="9">
                    <img class="phone-case-bg" src="mockups/pixel-tpu-view9.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/pixel-tpu-view9-overlay.png">
                </div>
                <div class="mockup-label">View 9</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="10">
                    <img class="phone-case-bg" src="mockups/pixel-tpu-view10.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/pixel-tpu-view10-overlay.png">
                </div>
                <div class="mockup-label">View 10</div>
            </div>
        </div>
    </div>
</div>


<!-- iPhone Fullprint Mockups -->
<div id="iphone-fullprint" class="case-mockups">
    <!-- Main Mockup -->
    <div id="main-mockup-container">
        <img class="phone-case-bg" src="mockups/iphone-fullprint-back-main.png">
        <div class="design-area">
            <img class="user-design" src="" alt="" 
                 data-x="48.5" data-y="48.5" data-scale="100" data-rotation="0">
        </div>
        <img class="phone-case-overlay" src="mockups/iphone-fullprint-overlay-main.png">
    </div>

    <!-- Secondary Mockups Grid -->
    <div class="grid-wrapper">
        <div class="grid-container">
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="1">
                    <img class="phone-case-bg" src="mockups/iphone-fullprint-view1.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="60" data-y="60" data-scale="60" data-rotation="30">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-fullprint-view1-overlay.png">
                </div>
                <div class="mockup-label">View 1</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="2">
                    <img class="phone-case-bg" src="mockups/iphone-fullprint-view2.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-fullprint-view2-overlay.png">
                </div>
                <div class="mockup-label">View 2</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="3">
                    <img class="phone-case-bg" src="mockups/iphone-fullprint-view3.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-fullprint-view3-overlay.png">
                </div>
                <div class="mockup-label">View 3</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="4">
                    <img class="phone-case-bg" src="mockups/iphone-fullprint-view4.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-fullprint-view4-overlay.png">
                </div>
                <div class="mockup-label">View 4</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="5">
                    <img class="phone-case-bg" src="mockups/iphone-fullprint-view5.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-fullprint-view5-overlay.png">
                </div>
                <div class="mockup-label">View 5</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="6">
                    <img class="phone-case-bg" src="mockups/iphone-fullprint-view6.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-fullprint-view6-overlay.png">
                </div>
                <div class="mockup-label">View 6</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="7">
                    <img class="phone-case-bg" src="mockups/iphone-fullprint-view7.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-fullprint-view7-overlay.png">
                </div>
                <div class="mockup-label">View 7</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="8">
                    <img class="phone-case-bg" src="mockups/iphone-fullprint-view8.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-fullprint-view8-overlay.png">
                </div>
                <div class="mockup-label">View 8</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="9">
                    <img class="phone-case-bg" src="mockups/iphone-fullprint-view9.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-fullprint-view9-overlay.png">
                </div>
                <div class="mockup-label">View 9</div>
            </div>
            <div class="grid-item">
                <div class="secondary-mockup">
                    <input type="checkbox" class="carousel-checkbox" data-view="10">
                    <img class="phone-case-bg" src="mockups/iphone-fullprint-view10.png">
                    <div class="design-area">
                        <img class="user-design" src="" alt="" 
                             data-x="50" data-y="50" data-scale="100" data-rotation="0">
                    </div>
                    <img class="phone-case-overlay" src="mockups/iphone-fullprint-view10-overlay.png">
                </div>
                <div class="mockup-label">View 10</div>
            </div>
        </div>
    </div>
</div>

            <!-- Plaques Section -->
    <div id="plaques" class="product-section">
        <div class="subtitle">Coming Soon - Plaque Mockups</div>
        <p>Plaque mockup generator will be available soon.</p>
    </div>
    
    <!-- T-Shirts Section -->
    <div id="tshirts" class="product-section">
        <div class="subtitle">Coming Soon - T-Shirt Mockups</div>
        <p>T-Shirt mockup generator will be available soon.</p>
    </div>
    
    <!-- Bags Section -->
    <div id="bags" class="product-section">
        <div class="subtitle">Coming Soon - Bag Mockups</div>
        <p>Bag mockup generator will be available soon.</p>
            </div>
        </div>
    </div>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
<script>
    // DOM Elements
    const imageUpload = document.getElementById('image-upload');
    const downloadBtn = document.getElementById('download-btn');
    const downloadZipBtn = document.getElementById('download-zip-btn');
    const productCategoryLinks = document.querySelectorAll('.product-category-link');
    const productTypeLinks = document.querySelectorAll('.product-type-link');
    const loadingElement = document.querySelector('.loading');
    
    // State variables
    let uploadedImage = new Image();
    const mockupCache = new Map();

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
        // Hide all case mockups except the first one
        document.querySelectorAll('.case-mockups').forEach((mockup, index) => {
            if (index !== 0) {
                mockup.classList.add('hidden');
            }
        });
    });

    // Product category selection
    productCategoryLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            
            // Update active category link
            productCategoryLinks.forEach(l => l.classList.remove('active'));
            this.classList.add('active');
            
            // Show selected product section
            const category = this.dataset.category;
            document.querySelectorAll('.product-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(category).classList.add('active');
        });
    });

    // Product type selection (for phone cases)
    productTypeLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            
            // Update active type link
            productTypeLinks.forEach(l => l.classList.remove('active'));
            this.classList.add('active');
            
            // Show selected mockups
            const caseType = this.dataset.case;
            document.querySelectorAll('.case-mockups').forEach(mockup => {
                mockup.classList.add('hidden');
            });
            document.getElementById(caseType).classList.remove('hidden');
            
            // Update design positions for the new case type
            if (uploadedImage.src) {
                document.querySelectorAll('.user-design').forEach(design => {
                    if (design.src) {
                        design.style.display = 'block';
                        updateDesignPosition(design);
                    }
                });
            }
        });
    });

    // Image upload handler
    imageUpload.addEventListener('change', function(event) {
        const file = event.target.files[0];
        if (!file) return;
        
        showLoading("Loading your design...");
        
        const reader = new FileReader();
        reader.onload = function(e) {
            // First verify the image loads
            const testImage = new Image();
            testImage.onload = function() {
                // Update all designs with the new image
                document.querySelectorAll('.user-design').forEach(design => {
                    design.src = e.target.result;
                    design.style.display = 'block';
                    updateDesignPosition(design);
                });
                
                uploadedImage.src = e.target.result;
                mockupCache.clear();
                hideLoading();
            };
            testImage.onerror = function() {
                hideLoading();
                alert("Error: The image couldn't be loaded. Please try another file.");
            };
            testImage.src = e.target.result;
        };
        reader.onerror = function() {
            hideLoading();
            alert("Error reading file. Please try again.");
        };
        reader.readAsDataURL(file);
    });

// Remove button handler
const removeBtn = document.getElementById('remove-btn');
removeBtn.addEventListener('click', function(e) {
    e.preventDefault();
    e.stopPropagation();
    
    document.querySelectorAll('.user-design').forEach(design => {
        design.src = '';
        design.style.display = 'none';
    });
    uploadedImage.src = '';
    imageUpload.value = '';
    mockupCache.clear();
    removeBtn.style.display = 'none';
});

// Modify the image upload handler to show the remove button when an image is uploaded
imageUpload.addEventListener('change', function(event) {
    const file = event.target.files[0];
    if (!file) return;
    
    showLoading("Loading your design...");
    
    const reader = new FileReader();
    reader.onload = function(e) {
        // First verify the image loads
        const testImage = new Image();
        testImage.onload = function() {
            // Update all designs with the new image
            document.querySelectorAll('.user-design').forEach(design => {
                design.src = e.target.result;
                design.style.display = 'block';
                updateDesignPosition(design);
            });
            
            uploadedImage.src = e.target.result;
            mockupCache.clear();
            removeBtn.style.display = 'block'; // Show remove button
            hideLoading();
        };
        testImage.onerror = function() {
            hideLoading();
            alert("Error: The image couldn't be loaded. Please try another file.");
        };
        testImage.src = e.target.result;
    };
    reader.onerror = function() {
        hideLoading();
        alert("Error reading file. Please try again.");
    };
    reader.readAsDataURL(file);
});
    
    // Function to update design position based on data attributes
    function updateDesignPosition(designElement) {
        const x = parseFloat(designElement.dataset.x) || 50;
        const y = parseFloat(designElement.dataset.y) || 50;
        const scale = parseFloat(designElement.dataset.scale) || 100;
        const rotation = parseFloat(designElement.dataset.rotation) || 0;
        
        designElement.style.top = `${y}%`;
        designElement.style.left = `${x}%`;
        designElement.style.transform = `translate(-50%, -50%) scale(${scale/100}) rotate(${rotation}deg)`;
    }

    // Optimized image loader with error handling
    async function loadImage(src) {
        return new Promise((resolve, reject) => {
            const img = new Image();
            img.onload = () => resolve(img);
            img.onerror = () => reject(new Error(`Failed to load image: ${src}`));
            img.src = src;
        });
    }

    // Generate mockup image with caching
    async function generateMockupImage(container) {
        const cacheKey = `${container.id}-${uploadedImage.src}`;
        if (mockupCache.has(cacheKey)) {
            return mockupCache.get(cacheKey);
        }

        showLoading("Generating mockup...");
        
        try {
            const canvas = document.createElement('canvas');
            canvas.width = 2000;
            canvas.height = 2000;
            const ctx = canvas.getContext('2d');

            const bg = await loadImage(container.querySelector('.phone-case-bg').src);
            const overlay = await loadImage(container.querySelector('.phone-case-overlay').src);

            // Draw background
            ctx.drawImage(bg, 0, 0, canvas.width, canvas.height);
            
            // Draw design if uploaded
            if (uploadedImage.src) {
                try {
                    const design = await loadImage(uploadedImage.src);
                    const designElement = container.querySelector('.user-design');
                    const x = parseFloat(designElement.dataset.x) || 50;
                    const y = parseFloat(designElement.dataset.y) || 50;
                    const scale = parseFloat(designElement.dataset.scale) || 100;
                    const rotation = parseFloat(designElement.dataset.rotation) || 0;
                    
                    const designScale = Math.min(
                        canvas.width / design.width,
                        canvas.height / design.height
                    ) * (scale / 100);
                    
                    const width = design.width * designScale;
                    const height = design.height * designScale;
                    
                    // Calculate position based on percentage values
                    const posX = (canvas.width * x / 100) - (width / 2);
                    const posY = (canvas.height * y / 100) - (height / 2);
                    
                    // Save context, rotate, then draw image
                    ctx.save();
                    ctx.translate(posX + width/2, posY + height/2);
                    ctx.rotate(rotation * Math.PI / 180);
                    ctx.drawImage(design, -width/2, -height/2, width, height);
                    ctx.restore();
                } catch (e) {
                    console.warn("Design image not loaded:", e.message);
                }
            }
            
            // Draw overlay
            ctx.drawImage(overlay, 0, 0, canvas.width, canvas.height);
            
            mockupCache.set(cacheKey, canvas);
            return canvas;
        } finally {
            hideLoading();
        }
    }

    // Download main mockup
    downloadBtn.addEventListener('click', async function() {
        if (!uploadedImage.src) {
            alert('Please upload an image first');
            return;
        }

        showLoading("Generating main mockup...");
        
        try {
            const activeCase = document.querySelector('.case-mockups:not(.hidden)');
            const mainContainer = activeCase.querySelector('#main-mockup-container');
            const canvas = await generateMockupImage(mainContainer);
            downloadBlob(await canvasToBlob(canvas), 'main-mockup.png');
        } catch (error) {
            console.error("Error generating mockup:", error);
            alert("Error generating mockup. Please try again.");
        } finally {
            hideLoading();
        }
    });

// Download selected mockups as ZIP
downloadZipBtn.addEventListener('click', async function() {
    if (!uploadedImage.src) {
        alert('Please upload an image first');
        return;
    }

    showLoading("Preparing ZIP file...");
    
    try {
        const activeCase = document.querySelector('.case-mockups:not(.hidden)');
        const checkedItems = activeCase.querySelectorAll('.carousel-checkbox:checked');
        
        if (checkedItems.length === 0) {
            alert('Please select at least one mockup view to download');
            return;
        }

        const zip = new JSZip();
        
        // Add main mockup to ZIP
        const mainContainer = activeCase.querySelector('#main-mockup-container');
        const mainCanvas = await generateMockupImage(mainContainer);
        const mainBlob = await canvasToBlob(mainCanvas);
        zip.file('main-mockup.png', mainBlob);
        
        // Process selected grid items with unique cache keys
        for (const item of checkedItems) {
            const mockupContainer = item.closest('.secondary-mockup');
            const viewNumber = item.dataset.view;
            
            // Generate unique cache key for each view
            const cacheKey = `view-${viewNumber}-${uploadedImage.src}`;
            
            // Skip cache for secondary views to ensure we get fresh renders
            showLoading(`Generating view ${viewNumber}...`);
            
            const canvas = document.createElement('canvas');
            canvas.width = 2000;
            canvas.height = 2000;
            const ctx = canvas.getContext('2d');

            const bg = await loadImage(mockupContainer.querySelector('.phone-case-bg').src);
            const overlay = await loadImage(mockupContainer.querySelector('.phone-case-overlay').src);

            // Draw background
            ctx.drawImage(bg, 0, 0, canvas.width, canvas.height);
            
            // Draw design
            const design = await loadImage(uploadedImage.src);
            const designElement = mockupContainer.querySelector('.user-design');
            const x = parseFloat(designElement.dataset.x) || 50;
            const y = parseFloat(designElement.dataset.y) || 50;
            const scale = parseFloat(designElement.dataset.scale) || 100;
            const rotation = parseFloat(designElement.dataset.rotation) || 0;
            
            const designScale = Math.min(
                canvas.width / design.width,
                canvas.height / design.height
            ) * (scale / 100);
            
            const width = design.width * designScale;
            const height = design.height * designScale;
            
            const posX = (canvas.width * x / 100) - (width / 2);
            const posY = (canvas.height * y / 100) - (height / 2);
            
            ctx.save();
            ctx.translate(posX + width/2, posY + height/2);
            ctx.rotate(rotation * Math.PI / 180);
            ctx.drawImage(design, -width/2, -height/2, width, height);
            ctx.restore();
            
            // Draw overlay
            ctx.drawImage(overlay, 0, 0, canvas.width, canvas.height);
            
            const blob = await canvasToBlob(canvas);
            zip.file(`view-${viewNumber}.png`, blob);
        }
        
        // Generate and download ZIP
        const content = await zip.generateAsync({ type: 'blob' });
        downloadBlob(content, 'mockups.zip');
        
    } catch (error) {
        console.error("Error generating ZIP:", error);
        alert("Error generating ZIP file. Please try again.");
    } finally {
        hideLoading();
    }
});

    // Helper functions
    function canvasToBlob(canvas) {
        return new Promise(resolve => {
            canvas.toBlob(blob => {
                resolve(blob);
            }, 'image/png', 0.95);
        });
    }
    
    function downloadBlob(blob, filename) {
        const link = document.createElement('a');
        link.download = filename;
        link.href = URL.createObjectURL(blob);
        document.body.appendChild(link);
        link.click();
        setTimeout(() => {
            URL.revokeObjectURL(link.href);
            link.remove();
        }, 100);
    }
    
    function showLoading(message = "Processing...") {
        loadingElement.innerHTML = `
            <div class="spinner"></div>
            <div>${message}</div>
        `;
        loadingElement.style.display = 'flex';
    }
    
    function hideLoading() {
        loadingElement.style.display = 'none';
    }
</script>
</body>
</html>
